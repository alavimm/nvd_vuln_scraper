Index: nvd_scraper.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\"\"\"\r\nVulnerability scrapper\r\nnvd database vulnerabilities extractor based on vendor and product and version required by user.\r\n\"\"\"\r\n\r\nimport time\r\nimport math\r\nimport bleach\r\nimport pandas as pd\r\nfrom selenium import webdriver\r\nfrom selenium.webdriver.common.by import By\r\nfrom schema import Schema, And, Use, SchemaError\r\nfrom selenium.webdriver.chrome.service import Service\r\nfrom selenium.webdriver.support.ui import WebDriverWait\r\nfrom webdriver_manager.chrome import ChromeDriverManager\r\nfrom selenium.webdriver.support import expected_conditions as ec\r\nfrom selenium.common.exceptions import TimeoutException, WebDriverException\r\n\r\n\r\ndef main(vendor, product, version):\r\n\r\n    # chrome options\r\n    options = webdriver.ChromeOptions()\r\n    options.headless = True\r\n    options.add_argument(\"start-maximized\")\r\n    options.add_argument(\"disable-infobars\")\r\n    options.add_argument(\"--disable-extensions\")\r\n    options.add_argument('--ignore-certificate-errors')\r\n    options.add_argument('--ignore-ssl-errors')\r\n    options.add_experimental_option('excludeSwitches', ['enable-logging'])\r\n\r\n    service = Service(ChromeDriverManager().install())\r\n    driver = webdriver.Chrome(service=service, options=options)\r\n\r\n    vuln_list = []\r\n    cols = [\"cve\", \"desc\", \"cvss\"]\r\n    num_of_vulns_per_page = 20\r\n\r\n    # get url\r\n    url = f\"https://nvd.nist.gov/vuln/search/results?form_type=Advanced&results_type=overview&search_type=all\" \\\r\n          f\"&isCpeNameSearch=false&cpe_vendor=cpe:/:{vendor}&cpe_product=cpe:/:{vendor}:{product}\" \\\r\n          f\"&cpe_version=cpe:/:{vendor}:{product}:{version}\"\r\n    driver.get(url)\r\n    # print(url)\r\n\r\n    total_vulns = driver.find_element(by=By.XPATH,\r\n                                      value='//*[@id=\"vulnerability-search-results-div\"]/div[1]/div[2]/strong').text\r\n    total_pages = math.ceil(int(total_vulns)/num_of_vulns_per_page)\r\n\r\n    while True:\r\n        try:\r\n            # get some fields and write them in the a file\r\n            cves = driver.find_elements(by=By.XPATH, value='//*[@id=\"row\"]/table/tbody/tr/th')\r\n            descs = driver.find_elements(by=By.XPATH, value='//*[@id=\"row\"]/table/tbody/tr/td[1]')\r\n            cvsses = driver.find_elements(by=By.XPATH, value='//*[@id=\"row\"]/table/tbody/tr/td[2]')\r\n\r\n            for (cve, desc, cvss) in (zip(cves, descs, cvsses)):\r\n                vuln_list.append((cve.text, desc.text, cvss.text))\r\n\r\n            current_page_number = driver.find_element(by=By.XPATH, value='//li[@class=\"active\"]/a').text\r\n            print(f\"{current_page_number} of {total_pages} pages fetched!\")\r\n            # WebDriverWait(driver, 10).until(ec.element_to_be_clickable((By.LINK_TEXT, '>'))).click()\r\n            driver.find_element(by=By.LINK_TEXT, value='>').click()\r\n\r\n        except WebDriverException:\r\n            print(\"There is not any more pages!\")\r\n            driver.quit()\r\n            break\r\n\r\n    driver.quit()\r\n\r\n    df = pd.DataFrame(vuln_list, columns=cols)\r\n    # print(df)\r\n\r\n    # df.to_csv(\"out.csv\", sep='\\t')\r\n    df.to_excel(\"out.xlsx\", index=False)\r\n\r\n\r\nif __name__ == \"__main__\":\r\n\r\n    schema = Schema([{'vendor': And(str, len),\r\n                      'product': And(str, len),\r\n                      'version': And(Use(float), lambda n: n > 0)}])\r\n\r\n    vend = bleach.clean(input(\"Vendor name: \"))\r\n    prod = bleach.clean(input(\"Product name: \"))\r\n    ver = bleach.clean(input(\"Version number: \"))\r\n\r\n    data = [{'vendor': vend, 'product': prod, 'version': ver}]\r\n\r\n    try:\r\n        schema.validate(data)\r\n        print(f\"Input data after sanitization and validation:\\nvendor: {vend}\\nproduct: {prod}\\nversion: {ver}\")\r\n        main(vend, prod, ver)\r\n        # main('google', 'android', '11.0')\r\n\r\n    except SchemaError:\r\n        print(f\"Input validation error!\")\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/nvd_scraper.py b/nvd_scraper.py
--- a/nvd_scraper.py	(revision 548e24983cd687e07911a1a7dce59ca37988266a)
+++ b/nvd_scraper.py	(date 1636750730636)
@@ -63,7 +63,7 @@
             driver.find_element(by=By.LINK_TEXT, value='>').click()
 
         except WebDriverException:
-            print("There is not any more pages!")
+            print("There are not any more pages!")
             driver.quit()
             break
 
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"ChangeListManager\">\r\n    <list default=\"true\" id=\"f4ee77d6-d9db-4eae-a5b3-351f9dea88bd\" name=\"Changes\" comment=\"some bugs fix\">\r\n      <change beforePath=\"$PROJECT_DIR$/out.xlsx\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/out.xlsx\" afterDir=\"false\" />\r\n    </list>\r\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\r\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\r\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\r\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\r\n  </component>\r\n  <component name=\"FileTemplateManagerImpl\">\r\n    <option name=\"RECENT_TEMPLATES\">\r\n      <list>\r\n        <option value=\"Python Script\" />\r\n      </list>\r\n    </option>\r\n  </component>\r\n  <component name=\"Git.Merge.Settings\">\r\n    <option name=\"BRANCH\" value=\"main\" />\r\n  </component>\r\n  <component name=\"Git.Settings\">\r\n    <option name=\"RECENT_BRANCH_BY_REPOSITORY\">\r\n      <map>\r\n        <entry key=\"$PROJECT_DIR$\" value=\"main\" />\r\n      </map>\r\n    </option>\r\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\r\n  </component>\r\n  <component name=\"ProjectId\" id=\"20oU3crfDbzvJ9P2lO67i7UX8ur\" />\r\n  <component name=\"ProjectLevelVcsManager\" settingsEditedManually=\"true\">\r\n    <ConfirmationsSetting value=\"2\" id=\"Add\" />\r\n  </component>\r\n  <component name=\"ProjectViewState\">\r\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\r\n    <option name=\"showLibraryContents\" value=\"true\" />\r\n  </component>\r\n  <component name=\"PropertiesComponent\">\r\n    <property name=\"ASKED_ADD_EXTERNAL_FILES\" value=\"true\" />\r\n    <property name=\"ASKED_SHARE_PROJECT_CONFIGURATION_FILES\" value=\"true\" />\r\n    <property name=\"ChangesTree.GroupingKeys\" value=\"\" />\r\n    <property name=\"RunOnceActivity.OpenProjectViewOnStart\" value=\"true\" />\r\n    <property name=\"RunOnceActivity.ShowReadmeOnStart\" value=\"true\" />\r\n    <property name=\"settings.editor.selected.configurable\" value=\"com.jetbrains.python.configuration.PyActiveSdkModuleConfigurable\" />\r\n  </component>\r\n  <component name=\"RunManager\">\r\n    <configuration name=\"nvd_scraper\" type=\"PythonConfigurationType\" factoryName=\"Python\" temporary=\"true\">\r\n      <option name=\"INTERPRETER_OPTIONS\" value=\"\" />\r\n      <option name=\"PARENT_ENVS\" value=\"true\" />\r\n      <envs>\r\n        <env name=\"PYTHONUNBUFFERED\" value=\"1\" />\r\n      </envs>\r\n      <option name=\"SDK_HOME\" value=\"C:\\Users\\yazahra\\PyCharmProjects\\nvd_vuln_scraper\\venv\\Scripts\\python.exe\" />\r\n      <option name=\"WORKING_DIRECTORY\" value=\"$PROJECT_DIR$\" />\r\n      <option name=\"IS_MODULE_SDK\" value=\"false\" />\r\n      <option name=\"ADD_CONTENT_ROOTS\" value=\"true\" />\r\n      <option name=\"ADD_SOURCE_ROOTS\" value=\"true\" />\r\n      <module name=\"\" />\r\n      <option name=\"SCRIPT_NAME\" value=\"$PROJECT_DIR$/nvd_scraper.py\" />\r\n      <option name=\"PARAMETERS\" value=\"\" />\r\n      <option name=\"SHOW_COMMAND_LINE\" value=\"false\" />\r\n      <option name=\"EMULATE_TERMINAL\" value=\"false\" />\r\n      <option name=\"MODULE_MODE\" value=\"false\" />\r\n      <option name=\"REDIRECT_INPUT\" value=\"false\" />\r\n      <option name=\"INPUT_FILE\" value=\"\" />\r\n      <method v=\"2\" />\r\n    </configuration>\r\n    <recent_temporary>\r\n      <list>\r\n        <item itemvalue=\"Python.nvd_scraper\" />\r\n      </list>\r\n    </recent_temporary>\r\n  </component>\r\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" transferred=\"true\" />\r\n  <component name=\"TaskManager\">\r\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\r\n      <changelist id=\"f4ee77d6-d9db-4eae-a5b3-351f9dea88bd\" name=\"Changes\" comment=\"\" />\r\n      <created>1636710236989</created>\r\n      <option name=\"number\" value=\"Default\" />\r\n      <option name=\"presentableId\" value=\"Default\" />\r\n      <updated>1636710236989</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00001\" summary=\"main file of repo\">\r\n      <created>1636713344218</created>\r\n      <option name=\"number\" value=\"00001\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00001\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1636713344218</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00002\" summary=\"main file of repo\">\r\n      <created>1636713749494</created>\r\n      <option name=\"number\" value=\"00002\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00002\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1636713749494</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00003\" summary=\"main file of repo\">\r\n      <created>1636726951468</created>\r\n      <option name=\"number\" value=\"00003\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00003\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1636726951468</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00004\" summary=\"main file of repo\">\r\n      <created>1636728034062</created>\r\n      <option name=\"number\" value=\"00004\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00004\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1636728034062</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00005\" summary=\"some bugs fix\">\r\n      <created>1636738564223</created>\r\n      <option name=\"number\" value=\"00005\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00005\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1636738564223</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00006\" summary=\"some bugs fix\">\r\n      <created>1636747708047</created>\r\n      <option name=\"number\" value=\"00006\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00006\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1636747708047</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00007\" summary=\"some bugs fix\">\r\n      <created>1636750280998</created>\r\n      <option name=\"number\" value=\"00007\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00007\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1636750280998</updated>\r\n    </task>\r\n    <option name=\"localTasksCounter\" value=\"8\" />\r\n    <servers />\r\n  </component>\r\n  <component name=\"Vcs.Log.Tabs.Properties\">\r\n    <option name=\"TAB_STATES\">\r\n      <map>\r\n        <entry key=\"MAIN\">\r\n          <value>\r\n            <State />\r\n          </value>\r\n        </entry>\r\n      </map>\r\n    </option>\r\n    <option name=\"oldMeFiltersMigrated\" value=\"true\" />\r\n  </component>\r\n  <component name=\"VcsManagerConfiguration\">\r\n    <option name=\"ADD_EXTERNAL_FILES_SILENTLY\" value=\"true\" />\r\n    <MESSAGE value=\"main file of repo\" />\r\n    <MESSAGE value=\"some bug fix\" />\r\n    <MESSAGE value=\"some bugs fix\" />\r\n    <option name=\"LAST_COMMIT_MESSAGE\" value=\"some bugs fix\" />\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision 548e24983cd687e07911a1a7dce59ca37988266a)
+++ b/.idea/workspace.xml	(date 1636750730752)
@@ -2,7 +2,7 @@
 <project version="4">
   <component name="ChangeListManager">
     <list default="true" id="f4ee77d6-d9db-4eae-a5b3-351f9dea88bd" name="Changes" comment="some bugs fix">
-      <change beforePath="$PROJECT_DIR$/out.xlsx" beforeDir="false" afterPath="$PROJECT_DIR$/out.xlsx" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/nvd_scraper.py" beforeDir="false" afterPath="$PROJECT_DIR$/nvd_scraper.py" afterDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
@@ -129,7 +129,14 @@
       <option name="project" value="LOCAL" />
       <updated>1636750280998</updated>
     </task>
-    <option name="localTasksCounter" value="8" />
+    <task id="LOCAL-00008" summary="some bugs fix">
+      <created>1636750639118</created>
+      <option name="number" value="00008" />
+      <option name="presentableId" value="LOCAL-00008" />
+      <option name="project" value="LOCAL" />
+      <updated>1636750639118</updated>
+    </task>
+    <option name="localTasksCounter" value="9" />
     <servers />
   </component>
   <component name="Vcs.Log.Tabs.Properties">
